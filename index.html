<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <title>Pushwoosh Web SDK 3.0 Demo</title>

  <!-- –ü–æ–¥–∫–ª—é—á–∞–µ–º SDK -->
  <script src="https://cdn.pushwoosh.com/webpush/v3/pushwoosh-web-notifications.js" defer></script>

  <script>
    var Pushwoosh = Pushwoosh || [];

    // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è SDK
    Pushwoosh.push(['init', {
      logLevel: 'debug',
      applicationCode: 'BF7A8-37DB4',
      apiToken: 'aZicon0JByIZpTAjnCR0SLfkGTSH2IrnNJkfGrzQlsguWEbf5iQpJzazSGMoJ0m1tj4XKvAl8lXFAfhvZIAm',
      defaultNotificationTitle: 'Pushwoosh Demo',
      defaultNotificationImage: 'https://upload.wikimedia.org/wikipedia/commons/thumb/a/a7/React-icon.svg/512px-React-icon.svg.png',
      defaultNotificationUrl: 'https://sappysue.github.io/',
      serviceWorkerUrl: 'pushwoosh-service-worker.js',
      autoSubscribe: false,
      subscribeWidget: { enable: false }
    }]);

    // –û–±—Ä–∞–±–æ—Ç–∫–∞ —Å–æ–±—ã—Ç–∏–π –∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ API –≥–ª–æ–±–∞–ª—å–Ω–æ
    Pushwoosh.push(['onLoad', function(api) {
      console.log('‚úÖ SDK –∑–∞–≥—Ä—É–∂–µ–Ω');
      window.pwApi = api; // ‚Üê —Å–æ—Ö—Ä–∞–Ω—è–µ–º API –≥–ª–æ–±–∞–ª—å–Ω–æ –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –∫–Ω–æ–ø–∫–æ–π

      Pushwoosh.addEventHandler('subscribe-success', function() {
        console.log('‚úÖ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø–æ–¥–ø–∏—Å–∞–ª—Å—è');
      });

      Pushwoosh.addEventHandler('subscribe-fail', function(error) {
        console.error('‚ùå –û—à–∏–±–∫–∞ –ø–æ–¥–ø–∏—Å–∫–∏:', error);
      });

      Pushwoosh.addEventHandler('receive-push', function(payload) {
        console.log('üì¨ –ü–æ–ª—É—á–µ–Ω–æ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ:', payload.notification);
      });

      Pushwoosh.addEventHandler('open-notification', function(payload) {
        console.log('üì® –û—Ç–∫—Ä—ã—Ç–æ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ:', payload.notification);
      });

      Pushwoosh.addEventHandler('hide-notification', function(payload) {
        console.log('üõë –ó–∞–∫—Ä—ã—Ç–æ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ:', payload.notification);
      });

      // –ü—Ä–æ–≤–µ—Ä–∏–º –≤—Ö–æ–¥—è—â–∏–µ —Å–æ–æ–±—â–µ–Ω–∏—è
      api.getInboxMessages().then(function(response) {
        console.log('üì• Inbox —Å–æ–æ–±—â–µ–Ω–∏—è:', response.messages);
      });
    }]);
  </script>
</head>
<body>
  <h1>Pushwoosh Web Push Demo</h1>

  <button onclick="subscribeUser()">üîî –ü–æ–¥–ø–∏—Å–∞—Ç—å—Å—è –Ω–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è</button>

  <script>
    function subscribeUser() {
      if (window.pwApi && pwApi.subscribeForPushNotifications) {
        pwApi.subscribeForPushNotifications().then(() => {
          console.log('‚úÖ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø–æ–¥–ø–∏—Å–∞–ª—Å—è –Ω–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è');
        }).catch((err) => {
          console.error('‚ùå –û—à–∏–±–∫–∞ –ø–æ–¥–ø–∏—Å–∫–∏:', err);
        });
      } else {
        console.warn('‚è≥ SDK –µ—â—ë –Ω–µ –≥–æ—Ç–æ–≤ –∏–ª–∏ API –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω');
      }
    }
  </script>
</body>
</html>
